# Download_Occurrence_Data.R
## Download Occurrence Data
## Original script by AE Melton. 
### Modified and created by ML Gaynor 
### Edited by Max Gebhart

### Load packages 
library(spocc)
library(scrubr)
library(dplyr)

### Data download using spocc
#### Using the package *spocc* we download data from iDigBio and GBIF.
#### We specified that coordinates are needed. Notice that the occurrence records for iDigBio and GBIF are stored sperately. 
## Before running the function we're going to put all of the synonyms 
#for each variable into the names in order to pull all possibly misnamed 
##data for each species and for our target species
{
  FRUSH <- c("Butomus umbellatus")
  SS <- c("Nitellopsis obtusa")
  CB <- c("Cyperus blepharoleptos", "Oxycaryum cubense", "Scirpus cubensis", "Anosporum cubense")
  }

Species_Pull <- function(x){
  occ(query = x, from = c('idigbio', 'bison'),limit = 70000, has_coords = T)
}

## This can be ran all at once for all the species 
{
  FR_data <- Species_Pull(FRUSH)
  SS_data <- Species_Pull(SS)
  CB_data <- Species_Pull(CB)
}


#### Processing spocc download
## The names for Helianthus were verified manually using the Plant List
# Functions can be made to make this quicker!
{
  But_umb_DF <- occ2df(FR_data) 
  But_umb_DF$name <- "Butomus umbellatus"
}
{
  write.csv(But_umb_DF, "Data Files/Butomus_umbellatus.csv", row.names = FALSE)
}
